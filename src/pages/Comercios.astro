---
import Layout from '../layouts/Layout.astro';
import Footer from "../components/Footer.astro";
import { supabase } from '../supabaseClient';

const categories = [
  { name: "Ferreteria", icon: "ðŸ› ï¸" },
  { name: "Almacen", icon: "ðŸ›’" },
  { name: "Taller", icon: "ðŸ§‘â€ðŸ”§" },
  { name: "Verduleria | Carniceria", icon: "ðŸ¥¬ðŸ¥©" },
  { name: "Web | Electronica", icon: "ðŸŒðŸ‘¨â€ðŸ’»" },
  { name: "Estetica | Indumentaria", icon: "ðŸ’…ðŸ‘•" },
  { name: "libreria", icon: "ðŸ“–" },
  { name: "Entretenimiento", icon: "ðŸ¤©" },
];

let comerciosLocales: any[] = [];

const { data, error } = await supabase
  .from('comercios_web_electronica')
  .select('image_profile, name, type, address');

if (error) {
  console.error('Error fetching data:', error);
} else {
  comerciosLocales = data;
}

let loading = true;

const fetchComercios = async () => {
  loading = true;
  const { data, error } = await supabase
    .from('comercios_web_electronica')
    .select('image_profile, name, type, address');
  if (error) {
    console.error('Error fetching data:', error);
  } else {
    comerciosLocales = data;
  }
  loading = false;
};

await fetchComercios();

---


<Layout class="container">
  <!-- Filtro para las categorÃ­as de los comercios -->
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <h1 class="text-2xl font-bold text-gray-800">Comercios</h1>
      <div class="mt-4 grid grid-cols-2 sm:grid-cols-4 gap-6 ">
        {categories.map((category) => (
          <div class="flex flex-col items-center bg-white shadow rounded-lg p-4 hover:cursor-pointer hover:bg-gray-100">
            <span class="text-4xl">{category.icon}</span>
            <p class="mt-2 text-gray-700">{category.name}</p>
          </div>
        ))}
      </div>
  </div>
  <!--------------------------------------------------->
  <!-- Comercios destacados -->
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <h2 class="text-2xl font-bold text-gray-800">comercios destacados</h2>
      <div class="mt-4 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">
        {loading ? (
          <p class="text-center text-gray-500">Cargando comercios...</p>
        ) : (
          comerciosLocales.map((comercio) => (
            <div class="flex flex-col bg-white shadow rounded-lg overflow-hidden hover:bg-gray-100 hover:cursor-pointer transform transition duration-300 hover:scale-102">
              <img src={comercio.image_profile} alt={comercio.name} class="h-48 w-full object-cover" />
              <div class="p-4">
                <h3 class="text-lg font-bold">{comercio.name}</h3>
                <p class="mt-2 text-gray-600">{comercio.type}</p>
                <p class="mt-2 text-gray-600">{comercio.address}</p>
              </div>
            </div>
          ))
        )}
        
      </div>
  </div>
  <!------------------------------------------------->
  <Footer />
</Layout>
